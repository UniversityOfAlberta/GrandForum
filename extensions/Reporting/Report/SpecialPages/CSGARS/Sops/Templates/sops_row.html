<td align="center" style="width:30px">
    <% if(sop_pdf != "") { %>
      <a href="<%= sop_pdf %>" target="_blank"><span class="pdf_gif"></span></a>
    <% } %>
    <% if(this.parent.model.year != ''){ %>
        <b><span><%= student_data.name %></b></span><br />
    <% } else { %>
        <b><span><a href="<%= sop_url %>" id="sop<%= id %>" target="_blank"><%= student_data.name %></a></b></span><br />
    <% } %>
    (<%=student_data.email %>)<br /><%= this.model.getAdditional('gender') %>
</td>

<td style="white-space: nowrap;" id='nationality_notes'>
  <% if(gsms_id != 0){ %>
    <%= gsms_id %><br />
  <% } %>
  <% if(this.model.getAdditional('applicant_number') != 0){ %>
    <%= this.model.getAdditional('applicant_number') %><br />
  <% } %>
  <% if(student_id != 0){ %>
    <%= student_id %><br />
  <% } %>
  <input type="checkbox" name="hidden" value="Hidden by me" <% if(this.model.hidden){ %> checked <% } %> /> Hidden by me <span id="hiddenThrobber" style="display:none;vertical-align:top;" class="throbber"></span>
</td>

<td style="white-space: nowrap;" id="gsms_pdf">
<% if(gsms_url != "") { %>
  <a href="<%= gsms_url %>" target="_blank"><span class="pdf_gif"></span></a><br />
<% } %>
</td>

<td style="white-space: wrap;" id='folder'>
    <%= this.model.getAdditional('folder') %>
</td>

<td style="white-space: nowrap;" id='dob'>
    <%= this.model.getAdditional('date_of_birth') %>
</td>

<td id='citizenship'>
    <%= this.model.getAdditional('country_of_citizenship_full') %>
</td>

<td style="white-space: nowrap;" id='applicant_type'>
    <%= this.model.getAdditional('applicant_type') %>
</td>

<td id='education_history' class="scrollableCell">
    <div class="scrollableCell"><%= this.model.getAdditional('education_history') %></div>
</td>

<td style="white-space: nowrap;" id='program_name'>
    <% var t = this.model.getAdditional('program_name').replace(/Master of Science/g, 'MSc.'); %>
    <%= t.replace(/Doctor of Philosophy/g, 'PhD') %>
</td>

<td style="white-space: nowrap;" id='epl'>
    <%= this.model.getAdditional('epl_test') %> <br /><%= this.model.getAdditional('epl_score') %> <br /><%= this.model.getAdditional('epl_listen') %> <br /><%= this.model.getAdditional('epl_write') %> <br /><%= this.model.getAdditional('epl_read') %> <br /><%= this.model.getAdditional('epl_speaking') %>
</td>

<!--  department specific -->
<td id='aos' class="scrollableCell">
    <div class="scrollableCell"><%= this.model.getAdditional('areas_of_study') %></div>
</td>

<td id='supervisors' class="scrollableCell">
    <div class="scrollableCell"><%= this.model.getAdditional('supervisors') %></div>
</td>

<td id='scholarships'>
    <%= this.model.getAdditional('scholarships_held') %>/<%= this.model.getAdditional('scholarships_applied') %>
</td>

<td align="right" id='gpaNormalized'>
    <%= this.model.getAdditional('gpaNormalized') %>
</td>

<td id='gres'>
    <%= this.model.getAdditional('gre1') %>, <%= this.model.getAdditional('gre2') %>, <%= this.model.getAdditional('gre3') %>, <%= this.model.getAdditional('gre4') %>
</td>

<td align="right" id='pubs'>
    <%= this.model.getAdditional('num_publications', 0) %>
</td>

<td align="right" id='awards'>
    <%= this.model.getAdditional('num_awards') %>
</td>

<td align="right" id='courses' class="scrollableCell">
  <div class="scrollableCell">
    <%= this.model.getAdditional('courses') %>
  </div>
</td>

<!-- reviewer info -->
<td style="white-space: nowrap;">
    <% for(var i=0; i < reviewers.length;i++){ %>
        <% if (reviewers[i].rank == "-1") { %>
            <!--%= reviewers[i].name %> (<span style="color: red;">-1</span>)-->
        <% } else { %>
            <%= reviewers[i].name %> (<%= reviewers[i].rank %>)
        <% } %>
  <br />
  <% } %>
  <% if(this.parent.model.year == ''){ %>
    <span class="assign_button" style="display:none"><a class="button" href="<%= wgServer+wgScriptPath %>/index.php/Special:AssignReviewer?student=<%= user_id %>">+</a></span>
  <% } %>
  
</td>

<!-- reviewer average -->
<td style="white-space: nowrap;">
    <% var avg=0; %>
    <% var ignore=0; %>
    <% for(var i=0; i < reviewers.length;i++){ %>
        <% if ((reviewers[i].rank != '--') && (reviewers[i].rank != "-1")) { %>
          <% avg += parseInt(reviewers[i].rank); %>
        <% } else { %>
          <% ignore += 1; %>
        <% } %>
    <% } %>
    <% avg /= reviewers.length - ignore; %>
    <% if(avg) { %> <%= avg.toFixed(2) %> <% } %>
</td>

<!-- faculty info -->
<td style="white-space: nowrap;">
  <% for(var i=0; i < other_reviewers.length;i++){ %>
        <% if (other_reviewers[i].rank == "-1") { %>
            <!--%= other_reviewers[i].name %> (<span style="color: red;">-1</span>)-->
        <% } else { %>
            <%= other_reviewers[i].name %> (<%= other_reviewers[i].rank %>)
        <% } %>
  <br />
  <% } %>
</td>

<!-- faculty average -->
<td style="white-space: nowrap;">
    <% var avg=0; %>
    <% var ignore=0; %>
    <% for(var i=0; i < other_reviewers.length;i++){ %>
        <% if (other_reviewers[i].rank != "-1" && other_reviewers[i].rank != "--") { %>
          <% avg += parseInt(other_reviewers[i].rank); %>
        <% } else { %>
          <% ignore += 1; %>
        <% } %>
    <% } %>
    <% avg /= other_reviewers.length - ignore; %>
    <% if(avg) { %> <%= avg.toFixed(2) %> <% } %>
</td>

<td id='notes' class="scrollableCell">
  <div class="scrollableCell" style="height:124px; max-height:124px;">
      <% _.each(this.model.getAdditional('notes'), function(note, key) { %>
        <% var lastname = me.get('lastname').replace(/[^\wA-zÀ-ÿ]/gi, '') %>
        <% if (key == lastname) { %>
          <font color="#007239" style="font-weight:bold"><%= key %></font>: <%= note %>
        <% } else { %>
          <font style="font-weight:bold"><%= key %></font>: <%= note %>
        <% } %>
        <br />
      <% }); %>
  </div>
  <% if(this.parent.model.year == ''){ %>
    <span class="assign_button" style="display:none" id="additionalNotes">
      <a class="button">+</a>
      <span class="throbber" style="display:none"></span>
    </span>
    <% var additionalNotesDialogId = 'additionalNotes_' + id; %>
    <div title="Additional Notes" id="<%= additionalNotesDialogId %>" style="display:none; z-index:10;"></div>
  <% } %>
</td>

<td style="width:200px" class="scrollableCell">
    <div class="scrollableCell"><span id="span<%= id %>"><%= comments %></span></div>
</td>

<td>
    <%= admit %>
</td>
