<?xml version="1.0" encoding="UTF-8" ?>
<Report name="Intake Form" reportType="RP_AVOID_SIMPLE" ajax="true" disabled="false">
    <Permissions>
        <Role role="INACTIVE+">
            <SectionPermission id="demographic" permissions="rw" />
            <SectionPermission id="nutrition1" permissions="rw" />
            <SectionPermission id="nutrition2" permissions="rw" />
            <SectionPermission id="submit" permissions="rw" />
        </Role>
    </Permissions>
    
    <Script>
        <![CDATA[
            <style>
                .requiredField {
                    padding: 5px;
                    margin-left: -5px;
                }
                
                .requiredFieldIncomplete {
                    background: #fdeeb2;
                }
            </style>
            <script type="text/javascript">
                
                setInterval(function(){
                    $("input, textarea, select", $(".requiredField")).each(function(i, el){
                        var requiredField = $(el).closest(".requiredField");
                        var name = $(el).attr('name');
                        var type = $(el).attr('type');
                        var tag = $(el).prop("tagName").toLowerCase();
                        if(type == "text" || type == "range" || tag == "textarea"){
                            if($(el).val() == ""){
                                requiredField.addClass("requiredFieldIncomplete");
                            }
                            else{
                                requiredField.removeClass("requiredFieldIncomplete");
                            }
                        }
                        else if(type == "radio" || type == "checkbox"){
                            if($("input[name='" + name + "']:checked").length == 0){
                                requiredField.addClass("requiredFieldIncomplete");
                            }
                            else{
                                requiredField.removeClass("requiredFieldIncomplete");
                            }
                        }
                        else if(tag == "select"){
                            if($("option:selected", el).val() == ""){
                                requiredField.addClass("requiredFieldIncomplete");
                            }
                            else{
                                requiredField.removeClass("requiredFieldIncomplete");
                            }
                        }
                    });
                    if($("#reportWarning").length == 0){
                        $("#reportFooter").prepend("<div id='reportWarning' style='display:none;margin:0;' class='warning'>" +
                                                        "You have not yet completed all of the questions." + 
                                                   "</div>");
                    }
                    if($(".selectedReportTab").text() != showLanguage(wgLang, "Consent", "Consentement")){
                        if($(".requiredFieldIncomplete:visible").length > 0){
                            $("button[type=submit]").hide();
                            $("#reportWarning").show();
                            $(".reportTab:not(.selectedReportTab)").addClass("disabled_lnk");
                        }
                        else{
                            $("button[type=submit]").show();
                            $("#reportWarning").hide();
                            $(".reportTab:not(.selectedReportTab)").removeClass("disabled_lnk");
                        }
                    }
                }, 250);
            </script>
        ]]>
    </Script>
    <ReportSection id="demographics" blobSection="AVOID_Demographics" type="NextPrevReportSection" pagebreak="false"
                   postId="Demographics" 
                   tooltip="Participant Demographic Questionnaire" 
                   name="Demographics" 
                   title="Participant Demographic Questionnaire">
        <!-- Gender -->
        <ReportItem id="socio_info2" type="RadioReportItem" blobItem="avoid_gender" 
                    options="Man|Woman|Nonbinary|Prefer to self describe myself">
            <![CDATA[
                <h3>What is your gender?</h3>
                <p><i>Gender refers to social roles and expectations, behaviors, expressions, and identities of girls, women, boys, men, and gender-diverse people.</i></p>
                <div class="requiredField">{$item}</div>
            ]]>
        </ReportItem>
        <ReportItem id="specify_socio_info2" type="Text" blobItem="GENDERSPECIFY" width="400px" optional="true">
            <![CDATA[
                <span id='specifygender'>
                    Please Specify
                    {$item}
                </span>
            ]]>
        </ReportItem>
        <Static>
            <![CDATA[
                <script type='text/javascript'>
                    $('span#specifygender').hide();
                    function specifyGender(){
                        if($("input:radio[value='Prefer to self describe myself']").is(':checked')){
                            $('span#specifygender').show();
                        }
                        else{ 
                            $('span#specifygender').hide(); 
                        }
                    }
                    _.defer(specifyGender);
                    $("input:radio[name='Demographics_socio_info2']").change(specifyGender);
                </script>
            ]]>
        </Static>
        
        <!-- Age -->
        <ReportItem id="socio_info1" type="SelectReportItem" blobItem="avoid_age" 
                    options="less than 60|60|61|62|63|64|65|66|67|68|69|70|71|72|73|74|75|76|77|78|79|80|81|82|83|84|85|86|87|88|89|90|91|92|93|94|95|96|97|98|99|100|101|102|103|104|105">
            <![CDATA[
                <h3>
                    What is your age?
                </h3>
                <div class="requiredField">{$item}</div>
            ]]>
        </ReportItem>
        
        <!-- Postal Code -->
        <ReportItem id="postalcode" type="Text" blobItem="POSTAL" width="45px" max_length="3">
            <![CDATA[
                <h3>What are the first three digits of your postal code (e.g. K7P)?</h3>
                <div class="requiredField">{$item} <span id="postalCodeError" class="inlineError" style="display:none;">This is not a valid postal code.</span></div>
                <script type="text/javascript">
                    $('[name=Demographics_postalcode]').on('input', function(){
                        $(this).val($(this).val().toUpperCase());
                        var val = $(this).val();
                        var matches = val.match(/[ABCEGHJKLMNPRSTVXY][0-9][ABCEGHJKLMNPRSTVWXYZ]|CFN/);
                        if(_.size(matches) != 1){
                            $('#postalCodeError').show();
                        }
                        else{
                            $('#postalCodeError').hide();
                        }
                    });
                    $('[name=Demographics_postalcode]').change(function(){
                        var val = $(this).val();
                        var matches = val.match(/[ABCEGHJKLMNPRSTVXY][0-9][ABCEGHJKLMNPRSTVWXYZ]|CFN/);
                        if(_.size(matches) != 1){
                            $(this).val('');
                        }
                    });
                </script>
            ]]>
        </ReportItem>
        
        <!-- Sexuality -->
        <ReportItem id="socio_info3" type="RadioReportItem" blobItem="avoid_sex" 
                    options="Straight or Heterosexual|Gay or Lesbian|Bisexual|Other sexual orientation">
            <![CDATA[
                <h3>Which of the following best describes your sexual orientation?</h3>
                <div class="requiredField">{$item}</div>
            ]]>
        </ReportItem>
        <ReportItem id="specify_socio_info3" type="Text" blobItem="SEXSPECIFY" width="400px" optional="true">
            <![CDATA[
                <span id='specifysex'>
                    Please Specify
                    {$item}
                </span>
            ]]>
        </ReportItem>
        <Static>
            <![CDATA[
                <script type='text/javascript'>
                    $('span#specifysex').hide();
                    function specifySex(){
                        if($("input:radio[value='Other sexual orientation']").is(':checked')){
                            $('span#specifysex').show();
                        }
                        else{ 
                            $('span#specifysex').hide(); 
                        }
                    }
                    _.defer(specifySex);
                    $("input:radio[name='Demographics_socio_info3']").change(specifySex);
                </script>
            ]]>
        </Static>
        
        <!-- Ethnicity -->
        <ReportItem id="ethnicity_avoid" type="CheckboxReportItem" blobType="BLOB_ARRAY" blobItem="ethnicity_avoid" orientation="vertical" 
                    options="Black|East Asian|Indigenous (First Nations, Inuk/Inuit, Métis)|Latin American|Middle Eastern|South Asian|Southeast Asian|White|Another race category|I don't know|Prefer not to answer|I prefer not to answer">
            <![CDATA[
                <p style='margin-top:2em; margin-bottom:-1em;'>In our society, people are often described by their race or racial background. These are not based in science, but our race may influence the way we are treated by individuals and institutions, and this may affect our health.</p>
                <h3>Which category(ies) best describes you? Check all that apply: </h3>
                <div class="requiredField">{$item}</div>
            ]]>
        </ReportItem>
        
        <!-- Indigenous -->
        <ReportItem id="ethnicity_indigenous" type="CheckboxReportItem" blobType="BLOB_ARRAY" blobItem="ethnicity_avoid2" orientation="vertical"
                    options="Yes, First Nations|Yes, Inuk/Inuit|Yes, Métis|No|I don't know|I prefer not to answer">
            <![CDATA[
                <h3>Do you identify as First Nations, Inuk/Inuit, and/or Métis? Check all that apply:</h3>
                <div class="requiredField">{$item}</div>
            ]]>
        </ReportItem>
    </ReportSection>
    
    <ReportSection id="nutrition" blobSection="AVOID_Nutrition" type="NextPrevReportSection" pagebreak="false"
                   postId="Nutrition" 
                   tooltip="Nutrition and Physical Activity Questionnaire" 
                   name="Nutrition / Physical Activity" 
                   title="Nutrition and Physical Activity Questionnaire">
        <Static>
            <![CDATA[
                <p>Please circle your response to each of the questions below.</p>
                <h3>I am able to:</h3>
                <table class='wikitable'>
                    <tr>
                        <th style='width: 27em;'></th>
                        <th style='width: 5.25em;'>Not at all</th>
                        <th style='width: 5.25em;'>A little</th>
                        <th style='width: 5.25em;'>Somewhat</th>
                        <th style='width: 5.25em;'>Mostly</th>
                        <th style='width: 5.25em;'>Completely</th>
                    </tr>
            ]]>
        </Static>
        <ReportItem id="able1" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="ABLE1">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>Eat a balanced diet</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="able2" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="ABLE2">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>Tell which foods are high in protein content</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="able3" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="ABLE3">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>Drink as much water as I need to drink every day</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="able4" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="ABLE4">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>Do exercises that are good for me</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="able5" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="ABLE5">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>Fit exercise into my regular routine</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="able6" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="ABLE6">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>Find ways to exercise that I enjoy</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="able7" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="ABLE7">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>Find accessible places for me to exercise in the community</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="able8" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="ABLE8">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>Figure out where to get information on how to take care of my health</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <Static>
            <![CDATA[
                </table>
            ]]>
        </Static>
        
        <Static>
            <![CDATA[
                <h3>How confident are you that you can exercise 3 times per week for 20 minutes in each of following situations?</h3>
                <table class='wikitable'>
                    <tr>
                        <th style='width: 27em;'></th>
                        <th style='width: 5.25em;'>Not confident at all</th>
                        <th style='width: 5.25em;'>A little confident</th>
                        <th style='width: 5.25em;'>Somewhat confident</th>
                        <th style='width: 5.25em;'>Mostly confident</th>
                        <th style='width: 5.25em;'>Very confident</th>
                    </tr>
            ]]>
        </Static>
        <ReportItem id="confident1" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="CONFIDENT1">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>When I am tired.</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="confident2" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="CONFIDENT2">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>When I have a lot of other things to do.</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="confident3" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="CONFIDENT3">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>When I am in a bad mood.</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="confident4" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="CONFIDENT4">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>When I feel I don’t have enough time.</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="confident5" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="CONFIDENT5">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>When I am feeling under pressure to get things done.</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="confident6" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="CONFIDENT6">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>When I am feeling ill.</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="confident7" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="CONFIDENT7">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>When I am feeling depressed.</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="confident8" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="CONFIDENT8">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>When I am feeling too old.</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="confident9" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="CONFIDENT9">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>When I am feeling too overweight</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <Static>
            <![CDATA[
                </table>
            ]]>
        </Static>
        
        <Static>
            <![CDATA[
                <h3>How confident are you that you can:</h3>
                <table class='wikitable'>
                    <tr>
                        <th style='width: 27em;'></th>
                        <th style='width: 5.25em;'>Not confident at all</th>
                        <th style='width: 5.25em;'>A little confident</th>
                        <th style='width: 5.25em;'>Somewhat confident</th>
                        <th style='width: 5.25em;'>Mostly confident</th>
                        <th style='width: 5.25em;'>Very confident</th>
                    </tr>
            ]]>
        </Static>
        <ReportItem id="can1" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="CAN1">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>Prepare healthy meals even when you feel tired?</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="can2" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="CAN2">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>Choose nutritious foods when shopping, even if certain foods are expensive or hard to find?</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="can3" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="CAN3">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>Maintain a balanced diet despite changes in appetite or taste?</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="can4" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="CAN4">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>Follow your dietary restrictions due to health conditions?</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <ReportItem id="can5" type="Radio" orientation="inline" options="1|2|3|4|5" blobItem="CAN5">
            <![CDATA[
                    <tr class='requiredField'>
                        <td>Eat healthily even if you feel lonely or depressed?</td>
                        {$item}
                    </tr>
            ]]>
        </ReportItem>
        <Static>
            <![CDATA[
                </table>
            ]]>
        </Static>
    </ReportSection>
    
    <ReportSection id="submit" type="EditableReportSection" blobSection="SUBMIT" 
                   postId="Submit"
                   name="{showLanguage(Submit, Soumettre)}">
        <If if="{and({==({getProgress(demographics)},100)}
                )}">
            <ReportItem id="submitted" type="TextReportItem" blobItem="SUBMITTED">
                <![CDATA[
                    <div id='submitDiv' style='display:none;'>{$item}</div>
                ]]>
            </ReportItem>
            <Static>
                <![CDATA[
                    <div>Submitting will mark your survey as 'complete' and will prevent you from editing in the future.</div><br />
                    <a class='button' id='submit_review'>Submit</a>
                    <script type='text/javascript'>
                        $('#reportFooter').prev().hide();
                        $('#reportFooter').hide();
                        $('#submit_review').click(function(){
                            $('#submitDiv input[type=text]').val('Submitted');
                            saveAll(function(){
                                window.location.href = wgServer + wgScriptPath + "/index.php/Special:AVOIDDashboard";
                            });
                        });
                    </script>
                ]]>
            </Static>
        </If>
        <Else>
            <![CDATA[
                You must complete all of the questions in the survey.
            ]]>
        </Else>
    </ReportSection>
</Report>
