<?xml version="1.0" encoding="UTF-8" ?>
<Report name="OT Form" reportType="RP_OT" pdfType="RPTP_OT" pdfFiles="OTFormPDF" ajax="true" disabled="false">
    <Permissions>
        <Role role="Applicant">
            <SectionPermission id="questions" permissions="rw" />
            <SectionPermission id="review" permissions="rw" />
            <SectionPermission id="eula" permissions="rw" />
            <SectionPermission id="submit" permissions="rw" />
        </Role>
    </Permissions>
    <ReportSection id="questions" tooltip="Questions" name="Questions" blobSection="OT_QUESTIONS" type="EditableReportSection" pagebreak="false">
        <ReportItem id="q1" type="TextareaReportItem" blobType="BLOB_TEXT" blobItem="Q1" limit="1800">
            <![CDATA[
                <h3>Describe how your personal background and experiences would make you a good occupational therapist.</h3>
                {$item}
            ]]>
        </ReportItem>
        <ReportItem id="q2" type="TextareaReportItem" blobType="BLOB_TEXT" blobItem="Q2" limit="1800">
            <![CDATA[
                <h3>Tell us about your work or volunteer experiences and how that would ultimately contribute to the profession of occupational therapy.</h3>
                {$item}
            ]]>
        </ReportItem>
        <ReportItem id="q3" type="TextareaReportItem" blobType="BLOB_TEXT" blobItem="Q3" limit="1800">
            <![CDATA[
                <h3>Tell us your academic experiences and how that has prepared you for being successful in the MScOT program at the University of Alberta.</h3>
                {$item}
            ]]>
        </ReportItem>
        <ReportItem id="q4" type="TextareaReportItem" blobType="BLOB_TEXT" blobItem="Q4" limit="1800">
            <![CDATA[
                <h3>Outline the key way Canada's health care system can meet the challenges of tomorrow.</h3>
                {$item}
            ]]>
        </ReportItem>
        <ReportItem id="q5" type="TextareaReportItem" blobType="BLOB_TEXT" blobItem="Q5" limit="900">
            <![CDATA[
                <h3>Is there anything else you would like to tell us to help the Admissions Committee in making their decision?</h3>
                {$item}
            ]]>
        </ReportItem>
    </ReportSection>
    <ReportSection id="gpa60_page" tooltip="Last 60 Credits GPA" name="Last 60 Credits GPA" blobSection="OT_QUESTIONS_gpa" type="EditableReportSection" pagebreak="false">

        <ReportItem id="qpa60q1" type="MultiTextReportItem" blobType="BLOB_ARRAY" blobItem="gpa60Entries" labels="Course Name|Grade|Credits" types="Text|Integer(,,2)|Integer" multiple="true" start="1" sizes="350|100|100">
            <![CDATA[
                <h3>Course History</h3>
                {$item}
                <div id='warning_container'></div>
            ]]>
        </ReportItem>

        <ReportItem id="qpa60q2" type="Text" blobType="BLOB_TEXT" editable="false" blobItem="gpa60Output" limit="100" width="100px" optional="true">
            <![CDATA[
                <h3>GPA<span title="Auto-calculated value from above courses" style="margin-left: 5px; cursor: default;" class="tooltip">&#9432;</span></h3>
                {$item}
                <script type="text/javascript">

                    var calculateGPAfull = function() {
                        _.defer(function() {
                            // get all the gpas from report item above this one
                            var elArray = $("*[name^='BestFullYearGPA_qpaFullq1'][name*='grade']");
                            var elArrayCredits = $("*[name^='BestFullYearGPA_qpaFullq1'][name*='credits']");
                            
                            // Calculate gpa
                            var sumGPA = 0;
                            for (var a = 0; a < elArray.length; a++) {
                                if (!_.isNaN(parseFloat(elArray[a].value))) {
                                    sumGPA += parseFloat(elArray[a].value);
                                }
                            }
                            var avg = sumGPA / Math.max(elArray.length, 1);                            
                            $('[name=BestFullYearGPA_qpaFullq2]').val(Number(Math.round(avg+'e2')+'e-2'));

                            // Count credits
                            var sumCredits = 0;
                            for (var a = 0; a < elArrayCredits.length; a++) {
                                if (!_.isNaN(parseFloat(elArrayCredits[a].value))) {
                                    sumCredits += parseFloat(elArrayCredits[a].value);
                                }
                            }

                            clearWarning('#warning_container');
                            clearSuccess('#warning_container');
                            if (sumCredits >= 60) {
                                $('#add_BestFullYearGPA_qpaFullq1').prop('disabled', true);
                            } else {
                                $('#add_BestFullYearGPA_qpaFullq1').prop('disabled', false);
                            }

                            if (sumCredits > 60) {
                                addWarning("More than 60 credits have been specified", false, '#warning_container');
                            } else if (sumCredits == 60) {
                                addSuccess("You have entered 60 credits", false, '#warning_container');
                            }


                        });
                    };

                    // set onChangeListeners
                    $(document).off("change", "*[name^='BestFullYearGPA_qpaFullq1'][name*='grade']");
                    $(document).off("click", "#table_BestFullYearGPA_qpaFullq1 button", calculateGPAfull);
                    $(document).off("change", "*[name^='BestFullYearGPA_qpaFullq1'][name*='credits']");
                    $(document).on("change", "*[name^='BestFullYearGPA_qpaFullq1'][name*='grade']", calculateGPAfull);
                    $(document).on("change", "*[name^='BestFullYearGPA_qpaFullq1'][name*='credits']", calculateGPAfull);
                    $(document).on("click", "#table_BestFullYearGPA_qpaFullq1 button", calculateGPAfull);
                    calculateGPAfull();

                </script>
            ]]>
        </ReportItem>

    </ReportSection>
    <ReportSection id="review" tooltip="Review of on-line report content" name="Review" blobSection="SEC_NONE" type="ReportSection" renderpdf="false">
        <ReportItem id="report_review" type="ReviewReportItem">
            <![CDATA[{$item}]]>
        </ReportItem>
    </ReportSection>
    <ReportSection id="eula" name="Declaration" title="Declaration" tooltip="Declaration" blobSection="OT_EULA" type="EULA">
        <ReportItem id="eula" type="EULA" blobItem="EULA" yes="&lt;b&gt;Yes&lt;/b&gt;, I agree to the above Declaration"
                                                          no="&lt;b&gt;No&lt;/b&gt;, I do not agree to the above Declaration">
            <![CDATA[
                <p>Personal information on this form is collected under the authority of Section 33(c) of Alberta’s Freedom of Information and Protection of Privacy Act and will be protected under Part 2 of that Act. It will be used for authorized purposes including admission and registration; administration of records, scholarships and awards, student services; and university planning and research. Students’ personal information may be used by academic and administrative units according to university policy, and operational needs. It is disclosed pursuant to federal and provincial regulatory reporting requirements, data sharing agreements with student governance associations, and to contracted or public health care providers as required. Direct any questions about this collection to the Admissions Services Supervisor, Faculty of Graduate Studies and Research, Killam Centre for Advanced Studies, 2-29 Triffo Hall, University of Alberta, Edmonton, AB T6G 2E1, 780-492-3499 or visit the <a href='http://www.ipo.ualberta.ca/' target='_blank'>Information and Privacy Office website</a>.</p>

                <p>You must agree to the following declaration before submitting your application:</p>
                <ul>
                    <li>I agree, if admitted to the University of Alberta, to comply with University regulations.</li>
                    <li>I certify that the information in this application is true and complete in all respects and that I have withheld no information.</li>
                    <li>I authorize the University to verify any information provided as part of this application.</li>
                    <li>I understand that misrepresentation, falsification of documents, or withholding of requested information regarding this application are serious offences and may result in prosecution under the University's Code of Applicant Behaviour, Code of Student Behaviour and/or the Criminal Code of Canada.</li>
                    <li>I attest that I have completed all questions to the best of my ability and without the assistance of other individuals.</li>
                </ul>
                {$item}
            ]]>
        </ReportItem>
    </ReportSection>
    <ReportSection id="submit" tooltip="PDF generation" name="Generate PDF" blobSection="SEC_NONE" type="ReportSection" renderpdf="false">
        <ReportItemSet id="if_eula" type="If" if="{==({getText(RP_OT,OT_EULA,EULA,0,{$user_id},0)},Yes)}">
            <ReportItem id="review" type="SimpleReviewSubmitReportItem" />
        </ReportItemSet>
        <ReportItem id="if_not_eula" type="If" if="{!=({getText(RP_OT,OT_EULA,EULA,0,{$user_id},0)},Yes)}">
            <![CDATA[
                <p>You need to accept the declaration before you complete the application.</p>
            ]]>
        </ReportItem>
    </ReportSection>
</Report>
