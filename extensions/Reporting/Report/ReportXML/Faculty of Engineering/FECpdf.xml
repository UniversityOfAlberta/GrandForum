<?xml version="1.0" encoding="UTF-8" ?>
<Report name="FEC" reportType="RP_FEC" pdfType="RPTP_FEC" headerName="{$user_name}" ajax="true" encrypt="true">
    <ReportSection id="cover" tooltip="Annual Report" name="Annual Report" title=" " blobSection="FEC_COVER" type="EditableReportSection" pagebreak="false" hLevel="2">
        <Static>
            <![CDATA[
                <style>
                    h2 {
                        margin-top: 1em !important;
                    }
                </style>
                <h1 style='text-align: center;'>
                    Faculty of Engineering<br />
                    ANNUAL REPORT of FACULTY MEMBER
                </h1>
                <h3 style='margin-top: -0.5em;'>Period: {time2date({$start_date}, F Y)} to {time2date({$end_date}, F Y)}</h3>
                <div style='display: inline-block; vertical-align: top; width: 50%;'>
                    <table class='wikitable'>
                        <tr><td><b>Name:</b></td><td>{$user_first_name} {$user_last_name}</td></tr>
                        <tr><td><b>Position:</b></td><td>{$user_level}</td></tr>
                        <tr><td><b>Department:</b></td><td>{$user_dept}</td></tr>
                        <!--tr><td><b>Date of Initial Appointment:&nbsp;&nbsp;&nbsp;</b></td><td>{$user_appointment_year}</td></tr-->
                        <tr><td><b>P.Eng. Status:</b></td><td>{getText(RP_FEC,PENG_STATUS,PENG_STATUS,0,{$user_id},0,0)}{if("{getText(RP_FEC,PENG_STATUS,PENG_STATUS,0,{$user_id},0,0,true)}" == "P.Eng.", &nbsp;&#40;{getText(RP_FEC,PENG_STATUS,PENG_STATUS_OTHER,0,{$user_id},0,0)}&#41;)}</td></tr>
                    </table><br />
                </div>
                
                <div style='display: inline-block; vertical-align: top;'>
                    <table class='wikitable'>
                        {if("{getFecPersonalInfo(dateOfPhd)}" != "", <tr><td><b>Date of PhD:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateOfPhd)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateOfAppointment)}" != "", <tr><td><b>Date of Appointment:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateOfAppointment)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateOfAssistant)}" != "", <tr><td><b>Date of Assistant:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateOfAssistant)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateOfAssociate)}" != "", <tr><td><b>Date of Associate:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateOfAssociate)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateOfProfessor)}" != "", <tr><td><b>Date of Professor:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateOfProfessor)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateFso2)}" != "", <tr><td><b>Date of FSO II:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateFso2)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateFso3)}" != "", <tr><td><b>Date of FSO III:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateFso3)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateFso4)}" != "", <tr><td><b>Date of FSO IV:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateFso4)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateAtsec1)}" != "", <tr><td><b>Date of ATS I:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateAtsec1)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateAtsec2)}" != "", <tr><td><b>Date of ATS II:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateAtsec2)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateAtsec3)}" != "", <tr><td><b>Date of ATS III:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateAtsec3)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateOfProbation1)}" != "", <tr><td><b>End of Probation 1:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateOfProbation1)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateOfProbation2)}" != "", <tr><td><b>End of Probation 2:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateOfProbation2)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateOfTenure)}" != "", <tr><td><b>Date of Tenure:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateOfTenure)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateOfRetirement)}" != "", <tr><td><b>Date of Retirement:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateOfRetirement)}</td></tr>)}
                        {if("{getFecPersonalInfo(dateOfLastDegree)}" != "", <tr><td><b>Date of Last Degree:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(dateOfLastDegree)}</td></tr>)}
                        {if("{getFecPersonalInfo(lastDegree)}" != "", <tr><td><b>Last Degree:&nbsp;&nbsp;&nbsp;</b></td><td>{getFecPersonalInfo(lastDegree)}</td></tr>)}
                    </table><br />
                </div>
            ]]>
        </Static>
    </ReportSection>
    <ReportSection id="teaching" tooltip="TEACHING" name="Teaching" title="1. TEACHING" blobSection="FEC_TEACHING" type="EditableReportSection" pagebreak="false" hLevel="2">
        <Static>
            <![CDATA[
                <h3>(a) Courses Taught:</h3>
            ]]>
        </Static>
        <ReportItemSet type="String" array="{getTermsArray({$start_date},{$end_date})}">
            <Static>
                <![CDATA[
                    <h4>{getExtra()}</h4>
                ]]>
            </Static>
            <ReportItemSet type="PersonCourses" term="{removeSpaces({getExtra()})}" unique="true" exclude13Week="true">
                <Static>
                    <![CDATA[
                        <h4 style='padding: 0; margin-top:0; margin-bottom: 0.25em; margin-left:2em; font-size: 1em;'>{$course_subject} {$course_number} - {$course_title}</h4>
                        <div style='margin-left: 4em;'>
                            <table class='wikitable' frame='box' rules='all' style='width:100%;'>
                                <tr>
                                    <th>Section</th>
                                    <th>Names of all instructors and<br />percentage of course instruction</th>
                                    <th style='width:10%;'>Calendar<br />Hours</th>
                                    <th>Your Actual Weekly<br />Average Contact Hours<br />(indicate if a reading course)</th>
                                    <th>Actual<br />Number of<br />Students</th>
                                </tr>
                    ]]>
                </Static>
                <ReportItemSet type="CourseSections">
                    <Static>
                        <![CDATA[
                            <tr>
                                <td>{$course_comp} - {$course_section}</td>
                        ]]>
                    </Static>
                    <ReportItem id="percent" type="TextareaReportItem" blobItem="FEC_COURSE_PERCENT" blobType="BLOB_TEXT" encrypt="true" height="65px">
                        <![CDATA[
                            <td valign='top'>
                                {$item}<br />
                                {$user_name}: {$course_percent}% of instruction
                            </td>
                        ]]>
                    </ReportItem>
                    <ReportItem id="calendar" type="TextReportItem" blobItem="FEC_COURSE_CALENDAR" blobType="BLOB_TEXT" encrypt="true" width="100px">
                        <![CDATA[
                            <td align='center'>{$item}</td>
                        ]]>
                    </ReportItem>   
                    <ReportItem id="contact" type="TextareaReportItem" blobItem="FEC_COURSE_CONTACT" blobType="BLOB_TEXT" encrypt="true" height="65px">
                        <![CDATA[
                            <td valign='top'>
                                {$item}
                            </td>
                        ]]>
                    </ReportItem>
                    <Static>
                        <![CDATA[
                            <td align='center'>{$course_enroll}</td>
                            </tr>
                        ]]>
                    </Static>
                </ReportItemSet>
                <If if="{!=({getBlobMD5(RP_FEC,FEC_TEACHING,SYLLABUS,0,{$user_id},{$course_id})},)}">
                    <![CDATA[
                        <tr>
                            <td valign='top' colspan='5'>
                                <a class="externalLink" href="{$wgServer}{$wgScriptPath}/index.php?action=downloadBlob&id={getBlobMD5(RP_FEC,FEC_TEACHING,SYLLABUS,0,{$user_id},{$course_id})}">Course Syllabus</a>
                            </td>
                        </tr>
                    ]]>
                </If>
                <ReportItem id="reflection" type="TextareaReportItem" blobItem="FEC_COURSE_REFLECTION" blobType="BLOB_TEXT" encrypt="true">
                    <![CDATA[
                        <tr>
                            <td valign='top' colspan='5'>
                                <b>Reflection:</b><br />
                                {$item}
                            </td>
                        </tr>
                    ]]>
                </ReportItem>
                <Static>
                    <![CDATA[
                        </table></div>
                    ]]>
                </Static>
            </ReportItemSet>
        </ReportItemSet>
        <If if="{!=({getArray(RP_FEC,FEC_TEACHING,FEC_PROJECT_COURSES,0,{$user_id},0,projectCourses)},)}">
            <Static>
                <![CDATA[
                    <h4>Project Courses</h4>
                    <table class="wikitable" frame="box" rules="all" width="100%">
                ]]>
            </Static>
            <ReportItemSet id="projectCourses_array" type="ArrayReportItemSet" array="{getArray(RP_FEC,FEC_TEACHING,FEC_PROJECT_COURSES,0,{$user_id},0)}" index="projectCourses">
                <Static>
                    <![CDATA[
                        <tr>
                            <td style="white-space:nowrap;width:10%;">
                                {getExtra(classprefix)} {getExtra(number)}<br />
                                &nbsp;&nbsp;#{getExtra(type)}: {add({occurrences({getExtra(term)},;)},1)}
                            </td>
                            <td width="">{getExtra(title)}<br />{getExtra(description)}</td>
                            <td style="width:45%;"><b>{getExtra(term)}</b>: {add({occurrences({getExtra(term)},;)},1)} {getExtra(type)} ({getExtra(enrolment)})</td>
                        </tr>
                    ]]>
                </Static>
            </ReportItemSet>
            <Static>
                <![CDATA[
                    </table>
                ]]>
            </Static>
        </If>
        <Static>
            <![CDATA[
                <h3>(b) Instructional Performance Reviews:</h3>
                <ul>
            ]]>
        </Static>
        <If if="{!=({getBlobMD5(RP_FEC,FEC_TEACHING,EVAL1,0,{$user_id},0)},)}">
            <![CDATA[
                <li><a class="externalLink" href="{$wgServer}{$wgScriptPath}/index.php?action=downloadBlob&id={getBlobMD5(RP_FEC,FEC_TEACHING,EVAL1,0,{$user_id},0)}">Classroom Performance Evaluation: Peer Review</a></li>
            ]]>
        </If>
        <If if="{!=({getBlobMD5(RP_FEC,FEC_TEACHING,EVAL2,0,{$user_id},0)},)}">
            <![CDATA[
                <li><a class="externalLink" href="{$wgServer}{$wgScriptPath}/index.php?action=downloadBlob&id={getBlobMD5(RP_FEC,FEC_TEACHING,EVAL2,0,{$user_id},0)}">Classroom Performance Evaluation: Administration Review</a></li>
            ]]>
        </If>
        <If if="{!=({getBlobMD5(RP_FEC,FEC_TEACHING,EVAL3,0,{$user_id},0)},)}">
            <![CDATA[
                <li><a class="externalLink" href="{$wgServer}{$wgScriptPath}/index.php?action=downloadBlob&id={getBlobMD5(RP_FEC,FEC_TEACHING,EVAL3,0,{$user_id},0)}">Classroom Performance Evaluation: Other Review</a></li>
            ]]>
        </If>
        <Static>
            <![CDATA[
                </ul>
            ]]>
        </Static>
        <ReportItem id="accredidation" type="MultiText" blobItem="ACCREDIDATION" blobType="BLOB_ARRAY" labels="Contributions Toward Accreditation Efforts|Hours Invested" types="Textarea|CenterNumber" multiple="true" sizes="90%|10%" class="wikitable">
            <![CDATA[
                <h3>(c) Accreditation:</h3>
                {$item}
            ]]>
        </ReportItem>
    </ReportSection>
    <ReportSection id="initiatives" tooltip="EDUCATIONAL INITIATIVES" name="Educational Initiatives" title="2. EDUCATIONAL INITIATIVES" blobSection="FEC_INITIATIVES" type="EditableReportSection" pagebreak="false" hLevel="2">
        <ReportItem id="teaching_methods1" type="MultiText" blobItem="TEACHING_METHODS1" blobType="BLOB_ARRAY" labels="Course Number|Description and Educational Objective|Hours Invested|Method Used to Evaluate Initiative" types="Text|Textarea|CenterNumber|Textarea" class="wikitable" width="100%" multiple="true">
            <![CDATA[
                <h3>(a) Please briefly describe initiatives taken to improve your own teaching:</h3>
                <b>New teaching methods implemented:</b>
                {$item}
            ]]>
        </ReportItem>
        <ReportItem id="teaching_methods2" type="MultiText" blobItem="TEACHING_METHODS2" blobType="BLOB_ARRAY" labels="Course Number|Description and Educational Objective|Hours Invested|Method Used to Evaluate Initiative" types="Text|Textarea|CenterNumber|Textarea" class="wikitable" width="100%" multiple="true">
            <![CDATA[
                <b>Course or laboratory development:</b>
                {$item}
            ]]>
        </ReportItem>
        <ReportItem id="improve" type="Textarea" blobItem="IMPROVE">
            <![CDATA[
                <h3>(b) Please briefly describe initiatives taken to improve teaching (beyond your own) within the Faculty, at the University of Alberta, and externally:</h3>
                {$item}<br />
            ]]>
        </ReportItem>
        <ReportItem id="enhance" type="Textarea" blobItem="ENHANCE">
            <![CDATA[
                <h3>(c) Describe any activities and initiatives taken to enhance graduate student supervision and mentoring:</h3>
                {$item}<br />
            ]]>
        </ReportItem>
        <ReportItem id="activities" type="Textarea" blobItem="ACTIVITIES">
            <![CDATA[
                <h3>(d) List any engineering education-related scholarship activities:</h3>
                {$item}<br />
            ]]>
        </ReportItem>
    </ReportSection>
    <ReportSection id="supervision" tooltip="SUPERVISION OF TRAINEES" name="Supervision" title="3. SUPERVISION OF TRAINEES" blobSection="FEC_SUPERVISION" type="EditableReportSection" pagebreak="false" hLevel="2">
        <Static>
            <![CDATA[
                <style>
                    .phd .program               { display: none; }
                    .msc .program               { display: none; }
                    .pdf .program               { display: none; }
                    .visiting .program          { display: none; }
                    
                    .ugrad .admitted            { display: none; }
                    .ugrad .degree              { display: none; }
                    .ugrad .completed           { display: none; }
                    
                    .tech .program              { display: none; }
                    .tech .degree               { display: none; }
                    .tech .completed            { display: none; }
                    .tech .scholarships         { display: none; }
                    
                    .other .program             { display: none; }
                    .other .degree              { display: none; }
                    .other .completed           { display: none; }

                    .committee .program         { display: none; }
                    .committee .scholarships    { display: none; }
                    .committee .percent         { display: none; }
                </style>
            ]]>
        </Static>
        <ReportItemSet id="hqps" type="String" 
                                 array="phd|msc|engpdf|ugrad|engtech|visiting|other|committee"
                                 array2="Trainee Name|Student Name|Student Name|Student Name|Trainee Name|Student Name|Student Name|Student Name"
                                 labels="(a) Doctoral Students|(b) Master's Students|(c) Postdoctoral Fellows|(d) Undergraduate Students|(e) Research/Technical Assistants and Associates|(f) Visiting Students|(g) Other Trainees|(h) Student Supervisory Committee Membership">
            <Static>
                <![CDATA[
                    {set(text,Name of Scholarships&#44; if any)}
                ]]>
            </Static>
            <If if="{or({==({getExtra(value)},phd)},
                        {==({getExtra(value)},msc)},
                        {==({getExtra(value)},engpdf)},
                        {==({getExtra(value)},visiting)})}">
                <![CDATA[
                    {set(colspan,6)}
                    {set(rowspan,2)}
                ]]>
            </If>
            <ElseIf if="{==({getExtra(value)},ugrad)}">
                <![CDATA[
                    {set(colspan,4)}
                    {set(rowspan,2)}
                ]]>
            </ElseIf>
            <ElseIf if="{==({getExtra(value)},engtech)}">
                <![CDATA[
                    {set(colspan,4)}
                    {set(rowspan,1)}
                ]]>
            </ElseIf>
            <ElseIf if="{==({getExtra(value)},other)}">
                <![CDATA[
                    {set(colspan,4)}
                    {set(rowspan,2)}
                    {set(text,Training Details)}
                ]]>
            </ElseIf>
            <ElseIf if="{==({getExtra(value)},committee)}">
                <![CDATA[
                    {set(colspan,5)}
                    {set(rowspan,1)}
                ]]>
            </ElseIf>
            
            <Static>
                <![CDATA[
                    <h3>{getExtra(label)} ({getHQPCount({getExtra(value)})})</h3>
                ]]>
            </Static>
            <If if="{>({getHQPCount({getExtra(value)})}, 0)}">
                <Static>
                    <![CDATA[
                        <table class='wikitable {getExtra(value)}' frame='box' rules='all' width='100%'>
                            <tr>
                                <th class='student_name' style='width: 20%;'>{getExtra(value2)}</th>
                                <th class='time' style='width: 1%; white-space:nowrap;'>FT / PT</th>
                                <th class='percent' style='width: 1%; white-space:nowrap;'>%<br />Supervision</th>
                                <th class='program' style='width: 5%; white-space:nowrap;'>Trainee Program</th>
                                <th class='admitted' style='width: 10%;'>Year<br />Admitted</th>
                                <th class='degree' style='width: 25%;'>Degree<br />Sought</th>
                                <th class='completed' style='width: 10%;'>Year Degree<br />Expected or<br />Completed</th>
                                <th class='cosupervisors' style='width: 20%;'>Co-Supervisors</th>
                            </tr>
                    ]]>
                </Static>
                <ReportItemSet type="PersonSupervises" hqpType="{getExtra(value)}" start="{$start_date}" end="{$end_date}">
                    <ReportItem id="row" type="FootnotesReportItem" blobSubItem="{$user_id}_{$hqp_rel_position}">
                        <![CDATA[
                            <tr>
                                <td class='student_name' rowspan='{get(rowspan)}'>{$item}{$user_name}</td>
                        ]]>
                    </ReportItem>
                    <ReportItem id="time" type="Select" blobItem="TIME" blobSubItem="{$user_id}_{$hqp_rel_position}" options="FT|PT">
                        <![CDATA[
                            <td class='time' align='center'>{$item}</td>
                        ]]>
                    </ReportItem>
                    <ReportItem id="percent" type="Text" blobItem="PERCENT" blobSubItem="{$user_id}_{$hqp_rel_position}">
                        <![CDATA[
                            <td class='percent' align='center'>{$item}</td>
                        ]]>
                    </ReportItem>
                    <ReportItem id="program" type="Text" blobItem="PROGRAM" blobSubItem="{$user_id}_{$hqp_rel_position}">
                        <![CDATA[
                            <td class='program'>{$item}</td>
                        ]]>
                    </ReportItem>
                    <Static>
                        <![CDATA[
                                <td class='admitted' align='center'>{substr({getExtra(start_date)},0,4)}</td>
                                <td class='degree'>{getExtra(position)}</td>
                                <td class='completed' align='center'>{substr({getExtra(finish)},0,4)}</td>
                                <td class='cosupervisors'>{getText(RP_FEC, FEC_SUPERVISION, COSUPERVISORS, {$user_id}_{$hqp_rel_position}, {$my_id}, 0)}</td>
                        ]]>
                    </Static>
                    <Static>
                        <![CDATA[
                            </tr>
                        ]]>
                    </Static>
                    <ReportItem id="scholarships" type="Textarea" blobItem="SCHOLARSHIPS" blobSubItem="{$user_id}_{$hqp_rel_position}" height="48px">
                        <![CDATA[
                            <tr class='scholarships'><td class='scholarships' colspan='{get(colspan)}'>
                                {get(text)}:<br />
                                {$item}
                            </td></tr>
                        ]]>
                    </ReportItem>
                </ReportItemSet>
                <Static>
                    <![CDATA[
                        </table>
                    ]]>
                </Static>
                <!-- HQP Footnotes -->
                <Static>
                    <![CDATA[
                        <ul>
                    ]]>
                </Static>
                <ReportItemSet type="PersonSupervises" hqpType="{getExtra(value)}">
                    <ReportItem id="row" type="FootnotesReportItem" blobSubItem="{$user_id}_{$hqp_rel_position}" isTopAnchor="false">
                        <![CDATA[
                            <li style="page-break-inside: avoid;">
                                {$item}
                            </li>
                        ]]>
                    </ReportItem>
                </ReportItemSet>
                <Static>
                    <![CDATA[
                        </ul>
                    ]]>
                </Static>
            </If>
        </ReportItemSet>
    </ReportSection>
    <ReportSection id="research" tooltip="RESEARCH" name="Research" title="4. RESEARCH" blobSection="FEC_RESEARCH" type="EditableReportSection" pagebreak="false" hLevel="2">
        <Static>
            <![CDATA[
                <h3>(a) Research Area:</h3>
                <p><b>(i) Major Area:</b> {getText(RP_FEC,RESEARCH_AREA,RESEARCH_AREA,0,{$user_id},0,0)}{if({contains({getText(RP_FEC,RESEARCH_AREA,RESEARCH_AREA,0,{$user_id},0,0,true)}, Other)}, : {getText(RP_FEC,RESEARCH_AREA,RESEARCH_AREA_OTHER,0,{$user_id},0,0)})}</p>
                <p><b>(ii) Keywords:</b> {$user_keywords}</p>
                
                <h3>(b) Grants Awarded:</h3>
                <table class='wikitable' frame='box' rules='all' width='100%'>
                    <tr>
                        <th>Granting Body</th>
                        <th>Start Date</th>
                        <th>End Date</th>
                        <th>Average<br />Amount/Year</th>
                        <th>Total Award</th>
                        <th>Title</th>
                        <th>P.I.<br />(y/n)</th>
                        <th>Joint With</th>
                    </tr>
            ]]>
        </Static>
        <ReportItemSet id="grants" type="PersonGrantsReportItemSet" start="{$start_date}" end="{$end_date}">
            <ReportItem id="row" type="FootnotesReportItem" blobSubItem="{$grant_id}">
                <![CDATA[
                    <tr>
                        <td>{$grant_sponsor}</td>
                        <td>{$grant_start_date}</td>
                        <td>{$grant_end_date}</td>
                        <td align='right'>${$grant_average}</td>
                        <td align='right'>${$grant_total}</td>
                        <td><sup>{$item}</sup> {$grant_title_both}</td>
                        <td align='center'>{$grant_is_pi}</td>
                        <td>{$grant_people}</td>
                    </tr>
                ]]>
            </ReportItem>
        </ReportItemSet>
        <Static>
            <![CDATA[
                </table>
            ]]>
        </Static>
        
        <!-- Grants Footnotes -->
        <Static>
            <![CDATA[
                <ul>
            ]]>
        </Static>
        <ReportItemSet id="grants" type="PersonGrantsReportItemSet" start="{$start_date}" end="{$end_date}">
            <ReportItem id="row" type="FootnotesReportItem" blobSubItem="{$grant_id}" isTopAnchor="false">
                <![CDATA[
                    <li style="page-break-inside: avoid;">
                        {$item}
                    </li>
                ]]>
            </ReportItem>
        </ReportItemSet>
        <Static>
            <![CDATA[
                </ul>
            ]]>
        </Static>
        
        <ReportItem id="initiatives" type="Textarea" blobItem="INITIATIVES">
            <![CDATA[
                <h3>(c) Development of New Research Initiatives:</h3>
                <p>{$item}</p><br />
            ]]>
        </ReportItem>
    </ReportSection>
    <ReportSection id="publications" tooltip="SCHOLARLY PUBLICATIONS AND CONTRIBUTIONS" name="Scholarly Publications" title="5. SCHOLARLY PUBLICATIONS AND CONTRIBUTIONS" blobSection="FEC_PUBLICATIONS" type="EditableReportSection" pagebreak="false" hLevel="2">
        <ReportItemSet type="String" array="Publication|
                                            Publication|
                                            Publication|
                                            Patent/Spin-Off|
                                            Publication|
                                            Presentation|
                                            Contribution|
                                            Contribution|
                                            Contribution|
                                            Contribution" 
                                     array2="Journal Paper\|Preprint|
                                             Conference Paper|
                                             Book\|Book Chapter|
                                             |
                                             Journal Paper\|Journal Abstract\|White Paper\|Tech Report\|Manual\|Preprint|
                                             |
                                             Teaching|
                                             Research|
                                             Technical Committee/Board|
                                             Other"
                                     array3="Refereed Journals|
                                             Conference Proceedings|
                                             Books; Chapters in Books|
                                             Reports of Invention, Patents Filed, or Patents Awarded|
                                             Unrefereed Papers and Technical Reports Published|
                                             Presentations (indicate by an asterisk which author made the presentation)|
                                             Contributions to teaching and/or pedagogy|
                                             Contributions to research and/or professional practice|
                                             Research-based contributions to technical committees and boards|
                                             Other Contributions"
                                     array4="|
                                             |
                                             |
                                             |
                                             |
                                             |
                                             |
                                             |
                                             |
                                             "
                                     array5="Yes|
                                             |
                                             |
                                             |
                                             No|
                                             |
                                             |
                                             |
                                             |
                                             "
                                     array6="Publication|
                                             Publication|
                                             Publication|
                                             Publication|
                                             Publication|
                                             Publication|
                                             Contribution|
                                             Contribution|
                                             Contribution|
                                             Contributions">
            <Static>
                <![CDATA[
                    <h3>({alpha({$index})}) {getExtra(value3)}</h3>
                    {set(products, 0)}
                    <table id='products{$index}' class='wikitable' frame='box' rules='all' style='width: 100%;'>
                        <tr>
                            {if("{getExtra(value2)}" == "Technical Committee/Board", <th style='width: 1%;white-space:nowrap;'>Technical Committee/Board</th>)}
                            <th style='width: 99%;'>Publication</th>
                            <th style='white-space: nowrap;'>First Year Listed</th>
                ]]>
            </Static>
            <ReportItemSet id="products{$index}" type="PersonProductsReportItemSet" category="{getExtra(value)}" productType="{getExtra(value2)}" useProductYear="true" includeHQP="false" peerReviewed="{getExtra(value5)}" start="{$start_date}" end="{$end_date}" includeContributors="true">
                <Static>
                    <![CDATA[
                        {set(products, 1)}
                        <tr style="page-break-inside: avoid;">
                    ]]>
                </Static>
                <If if="{==({getExtra(value2)},Technical Committee/Board)}">
                    <![CDATA[
                            <td>{getExtra(value2)}</td>
                    ]]>
                </If>
                <ReportItem id="row" type="FootnotesReportItem" blobSubItem="{$product_id}">
                    <![CDATA[
                            <td>
                                {$item}
                    ]]>
                </ReportItem>
                <ReportItem id="annotation" type="AnnotateProductReportItem" blobItem="PRODUCT_ANNOTATION" blobType="BLOB_RAW" blobSubItem="{$product_id}" showStatus="true" showIF="false" optional="true">
                    <![CDATA[
                                <b>({$product_type})</b> {$item}
                                {if("{$product_contributors}" != "", Contributors: {$product_contributors})}
                            </td>
                    ]]>
                </ReportItem>
                <ReportItem id="first_time" type="SingleCheckbox" blobItem="FIRST_TIME" blobSubItem="{$product_id}" blobType="BLOB_TEXT" options="&#x2713;" labels="" encrypt="true">
                    <![CDATA[
                            <td align='center' style='font-size: 1.5em;'>{$item}</td>
                        </tr>
                    ]]>
                </ReportItem>
            </ReportItemSet>
            <Static>
                <![CDATA[
                    </table>
                    <ul>
                ]]>
            </Static>
            <ReportItemSet id="products{$index}" type="PersonProductsReportItemSet" category="{getExtra(value)}" productType="{getExtra(value2)}" useProductYear="true" includeHQP="false" peerReviewed="{getExtra(value5)}" start="{$start_date}" end="{$end_date}">
                <ReportItem id="row" type="FootnotesReportItem" blobSubItem="{$product_id}" isTopAnchor="false">
                    <![CDATA[
                        <li style="page-break-inside: avoid;">
                            {$item}
                        </li>
                    ]]>
                </ReportItem>
            </ReportItemSet>
            <Static>
                <![CDATA[
                    </ul>
                ]]>
            </Static>
            <If if="{==({get(products)},0)}">
                <![CDATA[
                    <style>
                        #products{$index} { display: none; }
                    </style>
                ]]>
            </If>
        </ReportItemSet>
    </ReportSection>
    <ReportSection id="university_activities" tooltip="UNIVERSITY AND RELATED LEADERSHIP ACTIVITIES" name="University Activities" title="6. UNIVERSITY AND RELATED LEADERSHIP ACTIVITIES" blobSection="FEC_UNIVERSITY_ACTIVITIES" type="EditableReportSection" pagebreak="false" hLevel="2">
        <ReportItem id="committees" type="MultiText" blobItem="COMMITTEES" blobType="BLOB_ARRAY" labels="Committee|Number of Members|Were You Chair?|Total Hours/Year" types="Text|Text|Select(Yes,No)|Text" multiple="true" class="wikitable">
            <![CDATA[
                <h3>(a) Major university, faculty and department committees and office:</h3>
                {$item}
            ]]>
        </ReportItem>
        <ReportItem id="initiative" type="Textarea" blobItem="INITIATIVE">
            <![CDATA[
                <h3>(b) Initiative taken to enhance student/faculty interaction:</h3>
                {$item}<br />
            ]]>
        </ReportItem>
        <ReportItem id="extension" type="Textarea" blobItem="EXTENSION">
            <![CDATA[
                <h3>(c) Faculty of Extension Activities:</h3>
                {$item}<br />
            ]]>
        </ReportItem>
        <ReportItem id="other" type="Textarea" blobItem="OTHER">
            <![CDATA[
                <h3>(d) Other: (Describe)</h3>
                {$item}<br />
            ]]>
        </ReportItem>
        
        <Static>
            <![CDATA[
                <h3>(e) Number of graduate student oral and examining committees you have served on in the past year:</h3>
                <table class='wikitable' frame='box' rules='all' width='100%'>
                    <tr>
                        <th>Committee Role</th>
                        <th style='width:1%;white-space:nowrap;'>Departmental</th>
                        <th style='width:1%;white-space:nowrap;'>External to<br />Departmental</th>
                        <th style='width:1%;white-space:nowrap;'>External to<br />University</th>
                    </tr>
                    <tr>
                        <td valign='top'>
                            Chair<br />
                            Examiner:<br />
                            &nbsp;&nbsp;&nbsp;&nbsp;PhD Candidacy<br />
                            &nbsp;&nbsp;&nbsp;&nbsp;PhD Thesis<br />
                            &nbsp;&nbsp;&nbsp;&nbsp;MSc Thesis<br />
                            &nbsp;&nbsp;&nbsp;&nbsp;MEng Project
                        </td>
            ]]>
        </Static>
        <!-- Departmental -->
        <ReportItem id="committee1_1" type="Integer" blobItem="COMMITTEE1_1" width="100px">
            <![CDATA[
                    <td valign='top' align='right'>
                        {$item}&nbsp;<br />
            ]]>
        </ReportItem>
        <ReportItem id="committee2_1" type="Integer" blobItem="COMMITTEE2_1" width="100px">
            <![CDATA[
                        &nbsp;<br />
                        {$item}&nbsp;<br >
            ]]>
        </ReportItem>
        <ReportItem id="committee3_1" type="Integer" blobItem="COMMITTEE3_1" width="100px">
            <![CDATA[
                        {$item}&nbsp;<br >
            ]]>
        </ReportItem>
        <ReportItem id="committee4_1" type="Integer" blobItem="COMMITTEE4_1" width="100px">
            <![CDATA[
                        {$item}&nbsp;<br >
            ]]>
        </ReportItem>
        <ReportItem id="committee5_1" type="Integer" blobItem="COMMITTEE5_1" width="100px">
            <![CDATA[
                        {$item}&nbsp;<br >
                    </td>
            ]]>
        </ReportItem>
        <!-- External to Departmental -->
        <ReportItem id="committee1_2" type="Integer" blobItem="COMMITTEE1_2" width="100px">
            <![CDATA[
                    <td valign='top' align='right'>
                        {$item}&nbsp;<br />
            ]]>
        </ReportItem>
        <ReportItem id="committee2_2" type="Integer" blobItem="COMMITTEE2_2" width="100px">
            <![CDATA[
                        &nbsp;<br />
                        {$item}&nbsp;<br >
            ]]>
        </ReportItem>
        <ReportItem id="committee3_2" type="Integer" blobItem="COMMITTEE3_2" width="100px">
            <![CDATA[
                        {$item}&nbsp;<br >
            ]]>
        </ReportItem>
        <ReportItem id="committee4_2" type="Integer" blobItem="COMMITTEE4_2" width="100px">
            <![CDATA[
                        {$item}&nbsp;<br >
            ]]>
        </ReportItem>
        <ReportItem id="committee5_2" type="Integer" blobItem="COMMITTEE5_2" width="100px">
            <![CDATA[
                        {$item}&nbsp;<br >
                    </td>
            ]]>
        </ReportItem>
        <!-- External to University -->
        <ReportItem id="committee1_3" type="Integer" blobItem="COMMITTEE1_3" width="100px">
            <![CDATA[
                    <td valign='top' align='right'>
                        {$item}&nbsp;<br />
            ]]>
        </ReportItem>
        <ReportItem id="committee2_3" type="Integer" blobItem="COMMITTEE2_3" width="100px">
            <![CDATA[
                        &nbsp;<br />
                        {$item}&nbsp;<br >
            ]]>
        </ReportItem>
        <ReportItem id="committee3_3" type="Integer" blobItem="COMMITTEE3_3" width="100px">
            <![CDATA[
                        {$item}&nbsp;<br >
            ]]>
        </ReportItem>
        <ReportItem id="committee4_3" type="Integer" blobItem="COMMITTEE4_3" width="100px">
            <![CDATA[
                        {$item}&nbsp;<br >
            ]]>
        </ReportItem>
        <ReportItem id="committee5_3" type="Integer" blobItem="COMMITTEE5_3" width="100px">
            <![CDATA[
                        {$item}&nbsp;<br >
                    </td>
            ]]>
        </ReportItem>
        <Static>
            <![CDATA[
                    </tr>
                </table>
            ]]>
        </Static>
        
        <ReportItem id="interest" type="Textarea" blobItem="INTEREST">
            <![CDATA[
                <h3>(f) Committees where you have expressed interest (e.g., put your name forward for nomination) that are not listed in Section 6(a):</h3>
                {$item}<br />
            ]]>
        </ReportItem>
        <ReportItem id="impact" type="Textarea" blobItem="IMPACT">
            <![CDATA[
                <h3>(g) Describe the impact of your service on the university:</h3>
                {$item}<br />
            ]]>
        </ReportItem>
    </ReportSection>
    <ReportSection id="professional_activities" tooltip="PROFESSIONAL LEADERSHIP ACTIVITIES" name="Professional Activities" title="7. PROFESSIONAL LEADERSHIP ACTIVITIES" blobSection="FEC_PROFESSIONAL_ACTIVITIES" type="EditableReportSection" pagebreak="false" hLevel="2">
        <ReportItem id="committees" type="MultiText" blobItem="COMMITTEES" blobType="BLOB_ARRAY" labels="Committee|Office Held|Total Hours/Year" types="Text|Text|Text" multiple="true" class="wikitable">
            <![CDATA[
                <h3>(a) International, national and regional committees, including technical and professional societies:</h3>
                {$item}
            ]]>
        </ReportItem>
        <ReportItem id="consulting" type="MultiText" blobItem="CONSULTING" blobType="BLOB_ARRAY" labels="Generic Description of Project|Academic Year|Summer Period" types="Text|Text|Text" multiple="true" class="wikitable">
            <![CDATA[
                <h3>(b) Professional consulting:</h3>
                <p>(i)</p>
                {$item}
            ]]>
        </ReportItem>
        <ReportItem id="names" type="Textarea" blobItem="NAMES">
            <![CDATA[
                <p>(ii) Names and nature of any continuing contractual arrangements with outside organizations.</p>
                {$item}<br />
            ]]>
        </ReportItem>
        <ReportItem id="impact" type="Textarea" blobItem="IMPACT">
            <![CDATA[
                <h3>(c) Describe the impact of your service on the profession:</h3>
                {$item}<br />
            ]]>
        </ReportItem>
    </ReportSection>
    <ReportSection id="awards" tooltip="HONOURS AND AWARDS" name="Awards" title="8. HONOURS AND AWARDS" blobSection="FEC_AWARDS" type="EditableReportSection" pagebreak="false" hLevel="2">
        <Static>
            <![CDATA[
                <table class='wikitable' frame='box' rules='all' width='100%'>
                    <thead>
                        <tr>
                            <th>Honour / Award</th>
                            <th>Category</th>
                            <th>Scope</th>
                            <th>Year</th>
                        </tr>
                    </thead>
            ]]>
        </Static>
        <ReportItemSet id="awards" type="PersonProductsReportItemSet" category="Award" includeHQP="false" start="{$start_date}" end="{$end_date}">
            <ReportItem id="row" type="FootnotesReportItem" blobSubItem="{$product_id}">
                <![CDATA[
                    <tr><td>{$item}{$product_citation}</td>
                        <td align='center'>{$product_type}</td>
                        <td align='center'>{$award_scope}</td>
                        <td align='center'>{$product_year}</td>
                    </tr>
                ]]>
            </ReportItem>
        </ReportItemSet>
        <Static>
            <![CDATA[
                </table>
            ]]>
        </Static>
        
        <!-- Awards Footnotes -->
        <Static>
            <![CDATA[
                <ul>
            ]]>
        </Static>
        <ReportItemSet id="awards" type="PersonProductsReportItemSet" category="Award" includeHQP="false" start="{$start_date}" end="{$end_date}">
            <ReportItem id="row" type="FootnotesReportItem" blobSubItem="{$product_id}" isTopAnchor="false">
                <![CDATA[
                    <li style="page-break-inside: avoid;">
                        {$item}
                    </li>
                ]]>
            </ReportItem>
        </ReportItemSet>
        <Static>
            <![CDATA[
                </ul>
            ]]>
        </Static>
    </ReportSection>
    <ReportSection id="misc" tooltip="ACCEPTED INVITATIONS TO SERVE" name="Accepted Invitations to Serve" title="9. ACCEPTED INVITATIONS TO SERVE" blobSection="FEC_MISCELLANEOUS" type="EditableReportSection" pagebreak="false" hLevel="2">
        <ReportItem id="session_chairs" type="Textarea" blobItem="SESSION_CHAIRS">
            <![CDATA[
                <h3>(a) Session Chairs</h3>
                {$item}<br />
            ]]>
        </ReportItem>
        <ReportItem id="peer_reviews" type="Textarea" blobItem="PEER_REVIEWS">
            <![CDATA[
                <h3>(b) Peer Reviews</h3>
                {$item}<br />
            ]]>
        </ReportItem>
        <ReportItem id="other" type="Textarea" blobItem="OTHER">
            <![CDATA[
                <h3>(c) Other</h3>
                {$item}<br />
            ]]>
        </ReportItem>
    </ReportSection>
    <ReportSection id="additional_information" tooltip="ADDITIONAL INFORMATION" name="Additional Information" title="10. ADDITIONAL INFORMATION" blobSection="FEC_ADDITIONAL_INFORMATION" type="EditableReportSection" pagebreak="true" hLevel="2">
        <ReportItem id="additional" type="Textarea" blobItem="ADDITIONAL">
            <![CDATA[
                <p>{$item}</p>
            ]]>
        </ReportItem>
    </ReportSection>
    <ReportSection id="spots" type="EditableReportSection" name="SPOTs" title="APPENDIX A: SPOTs" pagebreak="false" hLevel="2">
        <Static>
            <![CDATA[
                <div id="spots">
            ]]>
        </Static>
        <ReportItemSet type="String" array="{getTermsArray({$start_date},{$end_date})}">
            <Static>
                <![CDATA[
                    {set(term, {getExtra()})}
                ]]>
            </Static>
            <ReportItemSet type="PersonCourses" term="{removeSpaces({getExtra()})}" unique="true" exclude13Week="true">
                <ReportItemSet type="CourseSections">
                    <If if="{!=({course_eval(false)}, )}">
                        <![CDATA[
                            <h3>{get(term)} / {$course_subject} {$course_number} / {$course_comp} - {$course_section}</h3>
                            <b>{$course_eval_n}</b> respondents out of <b>{$course_enroll}</b> enrolled (<b>{round({multiply({divide({$course_eval_n},{$course_enroll})},100)},1)}%</b>)
                            <table class='wikitable' frame='box' rules='all' style='width:100%;'>
                                <tr>
                                    <th style='width: 1%;'>Q#</th>
                                    <th style='width: 1%;'>QText</th>
                                    <th style='width: 1%;'>R1</th>
                                    <th style='width: 1%;'>R2</th>
                                    <th style='width: 1%;'>R3</th>
                                    <th style='width: 1%;'>R4</th>
                                    <th style='width: 1%;'>R5</th>
                                    <th>Chart</th>
                                </tr>
                                {course_eval(false)}
                            </table><br /><br />
                            {course_eval_summary(false)}
                            <div class='pagebreak'></div>
                        ]]>
                    </If>
                </ReportItemSet>
            </ReportItemSet>
        </ReportItemSet>
        <Static>
            <![CDATA[
                </div>
            ]]>
        </Static>
    </ReportSection>
    <ReportSection id="teaching_attachments" tooltip="Documents Upload" name="Attachments" title="APPENDIX B: TEACHING ATTACHMENTS" blobSection="FEC_TEACHING" type="EditableReportSection" pagebreak="false" hLevel="2">
        <Static>
            <![CDATA[
                <ul>
            ]]>
        </Static>
        <If if="{!=({getBlobMD5(RP_FEC,FEC_TEACHING,EVAL1,0,{$user_id},0)},)}">
            <![CDATA[
                <li><a class="externalLink" href="{$wgServer}{$wgScriptPath}/index.php?action=downloadBlob&id={getBlobMD5(RP_FEC,FEC_TEACHING,EVAL1,0,{$user_id},0)}">Classroom Performance Evaluation: Peer Review</a></li>
            ]]>
        </If>
        <If if="{!=({getBlobMD5(RP_FEC,FEC_TEACHING,EVAL2,0,{$user_id},0)},)}">
            <![CDATA[
                <li><a class="externalLink" href="{$wgServer}{$wgScriptPath}/index.php?action=downloadBlob&id={getBlobMD5(RP_FEC,FEC_TEACHING,EVAL2,0,{$user_id},0)}">Classroom Performance Evaluation: Administration Review</a></li>
            ]]>
        </If>
        <If if="{!=({getBlobMD5(RP_FEC,FEC_TEACHING,EVAL3,0,{$user_id},0)},)}">
            <![CDATA[
                <li><a class="externalLink" href="{$wgServer}{$wgScriptPath}/index.php?action=downloadBlob&id={getBlobMD5(RP_FEC,FEC_TEACHING,EVAL3,0,{$user_id},0)}">Classroom Performance Evaluation: Other Review</a></li>
            ]]>
        </If>
        <Static>
            <![CDATA[
                </ul>
            ]]>
        </Static>
        <ReportItem id="report" type="UploadPDF" blobItem="EVAL1" blobType="BLOB_RAW" />
        <ReportItem id="report" type="UploadPDF" blobItem="EVAL2" blobType="BLOB_RAW" />
        <ReportItem id="report" type="UploadPDF" blobItem="EVAL3" blobType="BLOB_RAW" />
    </ReportSection>
    <ReportSection id="sabbatical1" tooltip="Documents Upload" name="Sabbatical Report" title="APPENDIX C.2: SABBATICAL REPORT" blobSection="FEC_ADDITIONAL_INFORMATION" type="EditableReportSection" pagebreak="false" hLevel="2">
        <ReportItem id="report" type="Upload" blobItem="SABBATICAL_REPORT" blobType="BLOB_RAW" mimeType="application/pdf" fileSize="20" encrypt="true" text="Sabbatical Report">
            <![CDATA[
                {$item}
            ]]>
        </ReportItem>
        <ReportItem id="report" type="UploadPDF" blobItem="SABBATICAL_REPORT" blobType="BLOB_RAW" />
    </ReportSection>
    <ReportSection id="sabbatical2" tooltip="Documents Upload" name="Sabbatical Application" title="APPENDIX C.1: SABBATICAL APPLICATION (PREVIOUSLY APPROVED)" blobSection="FEC_ADDITIONAL_INFORMATION" type="EditableReportSection" pagebreak="false" hLevel="2">
        <ReportItem id="report" type="Upload" blobItem="SABBATICAL_APPLICATION" blobType="BLOB_RAW" mimeType="application/pdf" fileSize="20" encrypt="true" text="Sabbatical Application">
            <![CDATA[
                {$item}
            ]]>
        </ReportItem>
        <ReportItem id="report" type="UploadPDF" blobItem="SABBATICAL_APPLICATION" blobType="BLOB_RAW" />
    </ReportSection>
    <ReportSection id="attachments" tooltip="Documents" name="Documents" title="APPENDIX D: OTHER ATTACHMENTS" blobSection="FEC_ADDITIONAL_INFORMATION" type="EditableReportSection" pagebreak="false" hLevel="2">
        <Static>
            <![CDATA[
                <ul>
            ]]>
        </Static>
        <For from="1" to="10">
            <Static>
                <![CDATA[
                    {set(md5, {getBlobMD5(RP_FEC,FEC_ADDITIONAL_INFORMATION,FILE{getExtra()},0,{$user_id},0)})}
                    {set(label, {getText(RP_FEC,FEC_ADDITIONAL_INFORMATION,FILE{getExtra()}_LABEL,0,{$user_id},0)})}
                ]]>
            </Static>
            <If if="{!=({getBlobMD5(RP_FEC,FEC_ADDITIONAL_INFORMATION,FILE{getExtra()},0,{$user_id},0)},)}">
                <Static>
                    <![CDATA[
                        <li><a class='externalLink' href='{$wgServer}{$wgScriptPath}/index.php?action=downloadBlob&id={get(md5)}'>Document {getExtra()}: {get(label)}</a></li>
                    ]]>
                </Static>
                <ReportItem id="file{getExtra()}" type="UploadPDF" blobItem="FILE{getExtra()}" blobType="BLOB_RAW" />
            </If>
        </For>
        <Static>
            <![CDATA[
                </ul>
            ]]>
        </Static>
    </ReportSection>
    <ReportSection id="submit" type="EditableReportSection" pagebreak="false">
        <!-- Only Used to Mark Products as Submitted -->
        <ReportItemSet id="submit1" type="PersonProductsReportItemSet" category="Publication" submitProductYear="true" useProductYear="true" includeHQP="true" start="{$start_date}" end="{$end_date}" />
        <ReportItemSet id="submit2" type="PersonProductsReportItemSet" category="Presentation" submitProductYear="true" useProductYear="true" includeHQP="true" start="{$start_date}" end="{$end_date}" includeContributors="true" />
        <ReportItemSet id="submit3" type="PersonProductsReportItemSet" category="Award" submitProductYear="true" useProductYear="true" includeHQP="false" start="{$start_date}" end="{$end_date}" />
    </ReportSection>
</Report>
