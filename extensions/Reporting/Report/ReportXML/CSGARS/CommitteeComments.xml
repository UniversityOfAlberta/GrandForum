<?xml version="1.0" encoding="UTF-8" ?>
<Report name="Committee Review" reportType="RP_COM" pdfType="RPTP_COM" pdfFiles="OTComPDF" ajax="true" disabled="false">
    <Permissions>
        <Role role="Faculty">
            <SectionPermission id="review student" permissions="r" />
            <SectionPermission id="review" permissions="r" />
            <SectionPermission id="submit" permissions="r" />
        </Role>
        <Role role="Manager">
            <SectionPermission id="review student" permissions="rw" />
            <SectionPermission id="review" permissions="rw" />
            <SectionPermission id="submit" permissions="rw" />
        </Role>
        <Role role="Admin">
            <SectionPermission id="review student" permissions="rw" />
            <SectionPermission id="review" permissions="rw" />
            <SectionPermission id="submit" permissions="rw" />
        </Role>
    </Permissions>
    <ReportSection id="review student" tooltip="Student Review" name="Review Student" blobSection="OT_COM" type="EditableReportSection" pagebreak="false">
        <ReportItem id="js" type="StaticReportItem">
            <![CDATA[
            <script type='text/javascript'>
            	$('#aboveTabs').hide();
            	$('#reportTabs').hide();
            	$('#reportHeader').hide();
            	$('#reportBody').css('min-height',0);

            	$(document).ready(function () {
                    $('input[value=\'Admit\']').click(function () {
                        $('#admit_opt').show();
                    });
                    $('input[value=\'Waitlist\']').click(function () {
                        $('#admit_opt').hide();
                    });
                    $('input[value=\'Reject\']').click(function () {
                        $('#admit_opt').hide();
                    });

                });



                var intervalId = setInterval(function(){
                    if ($('#admit_opt').is(':visible') && $('[value=Admit]').attr('checked') != 'checked'){
	                $('#admit_opt').hide();
                        clearInterval(intervalId);
                        intervalId = null;
                    }
                }, 100);
            </script>
            ]]>
        </ReportItem>
        <ReportItemSet id="if_statement" type="IfReportItemSet" if="{or({contains({$user_full_roles}, Chair)}, {contains({$user_full_roles}, Manager)},{contains({$user_full_roles}, Admin)})}">
            <!--
                <ReportItem id="q1" personId="0" type="RadioReportItem" blobItem="Q1" blobType="BLOB_TEXT" options="Admit|Reject|Waitlist" blobSubItem="{$project_id}" sopBlob="true" orientation = "horizontal">
                    <![CDATA[
                    <tr><td><span 'style=font:size 14px;'><h3>Final Decision:</h3></span></td><td>
                        {$item}</td></tr><br /><br />
                    ]]>
                </ReportItem> 
            -->
                <ReportItem id="q1" personId="0" type="RadioReportItem" blobItem="Q1" blobType="BLOB_TEXT" options="Admit|Reject|Waitlist" blobSubItem="{$project_id}" sopBlob="true" orientation = "horizontal">
                    <![CDATA[
                    <div style="height:30px;">
                        <span title="This decision is made in GSMS" class="tooltip" style="font-size:14px; border-bottom: 1px dotted #555;">
                            <b>Final Decision</span>:</b>
                        <span style="font-size:14px; margin-left:6px;">{$finalDecision}</span>
                    </div>
                    ]]>
                </ReportItem>

            <ReportItemSet id="if_statement" type="IfReportItemSet" if="{contains({$finalDecision}, Admit)}">
    	        <ReportItem id="program" personId="0" type="Text" blobItem="Q3" blobSubItem="{$project_id}">
            	    <![CDATA[
                    	<span id='admit_opt'><table style="margin-left:16px;"><tr><td><b>Program:</b></td><td>{$item}</td></tr>
               	    ]]>
            	</ReportItem>
                <ReportItem id="funding" personId="0" type="RadioReportItem" blobItem="Q4" blobType="BLOB_TEXT" options="Yes|No" sopBlob="true" orientation = "horizontal" blobSubItem="{$project_id}">
                    <![CDATA[
                        <tr><td><b>Funding:</b></td><td> {$item}</td></tr>
                    ]]>
                </ReportItem>
                <ReportItem id="q5" type="FacultyMembersReportItem" url='https://forum-fos.ualberta.ca/index.php?action=api.people/Faculty' blobType="BLOB_ARRAY" blobItem="Q14" limit="900" delimiter="; " max="3" width="300px">
                    <![CDATA[
                        <tr><td><b>Supervisor:</b></td><td>{$item}</td></tr>
                    ]]>
                </ReportItem>
                <ReportItem id="area" personId="0" type="Text" blobItem="Q5" blobType="BLOB_TEXT" sopBlob="true" blobSubItem="{$project_id}">
                    <![CDATA[
                        <tr><td><b>Area:</b></td><td> {$item}</td></tr>
                    ]]>
                </ReportItem>
                <ReportItem id="degree" personId="0" type="RadioReportItem" blobItem="Q6" blobType="BLOB_TEXT" options="PhD|MSc|MSc course based" sopBlob="true" orientation = "horizontal" blobSubItem="{$project_id}">
                    <![CDATA[
                        <tr><td><b>Degree:</b></td><td> {$item}</td></tr>
                    ]]>
                </ReportItem>
                <ReportItem id="status" personId="0" type="RadioReportItem" blobItem="Q7" blobType="BLOB_TEXT" options="FT|PT" sopBlob="true" orientation = "horizontal" blobSubItem="{$project_id}">
                    <![CDATA[
                        <tr><td><b>Full time/Part time:</b></td><td> {$item}</td></tr></table></span>
                    ]]>
                </ReportItem>
            </ReportItemSet>

        	<ReportItem id="q2" personId="0" type="TextareaReportItem" blobType="BLOB_TEXT" blobItem="Q2" rich="true" limit="150" blobSubItem="{$project_id}">
                <![CDATA[
		<span 'style=font:size 14px;'><h3>Comments:</h3></span>
            	{$item}
                ]]>
            </ReportItem>
        </ReportItemSet>

        <ReportItemSet id="if_statement" type="IfReportItemSet" if="{and({!contains({$user_full_roles},Manager)},{!contains({$user_full_roles}, Chair)})}">
            <ReportItem id="comment_unedit" type="StaticReportItem">
                <![CDATA[
		Decision:<br />{$finalDecision}<br /><br />
		Comments:<br />
                {getText(RP_COM,OT_COM,Q2,{$project_id},0,{$project_id})}
                ]]>
            </ReportItem>
        </ReportItemSet>
    </ReportSection>
    <ReportSection id="review" tooltip="Review of on-line report content" name="Review" blobSection="SEC_NONE" type="ReportSection" renderpdf="false">
        <ReportItem id="report_review" type="ReviewReportItem">
            <![CDATA[{$item}]]>
        </ReportItem>
    </ReportSection>
    <ReportSection id="submit" tooltip="PDF generation of the Review" name="Generate PDF" blobSection="SEC_NONE" type="ReportSection" renderpdf="false">
        <Instructions>
            <![CDATA[
            
            ]]>
        </Instructions>
        <ReportItem id="review" type="SimpleReviewSubmitReportItem" />
    </ReportSection>
    
</Report>
